Notes on Letter_y50 js file


General
	Made copy to modify
	Used regular expressions to strip out \\\\ for each line. The code lines were hiding behind this. 
	Next I used re to clear out all other text, re: \\.*. This cleared out all the junk lines that were hiding the code.
	Lastly I removed all emtpy lines carriage returns, re: ^\n

	Began analysis

	- File attempts to enumerate drives detected on the system to find a valid drive letter not in use
	- Checks if it's share already exists. Uses a try catch statment to keep going if the drive exists
	- uses net use to connect to make a persistent mapped connection to 178.23.190.199:80\share
	- Waits 30 seconds after creating
	- Verifies its connected then continues on
	- Makes a call to msiexec to install gsm.msi with the flags /q and n for quiet install (in the newly created share directory)
	- Script continues by make a new ActiveXObject scripting.filesystemobject
	- Try catch to see if a script exists
	- Loops through, reading each line
	- Assigns the readlines as a variable 'a'
	- Assigns this to a new function, function(a) 
	- Catches if this doesn't happen
	- stage1 script ends at this point


	Analysis of teh gsm.msi file
	- Ran strings to a file
	- strings were all bunched up. Manually had to separate some. Others I could separate based on the semi colon.
	- Reviewed strings
	- Installed msitools
	- Ran msidump and extracted the streams
	- Inside were 8 jpg files, 2 svg files, an exe, cab, dll, and other binary files
	- Analyzed the files. Everything seemed fine until I ran into the disk1.cab file. This was flagged, like the msi as IceID. 
	- Ran 7zip to extract the contents from the .cab file. This showed a map.dll.


	- Run msiinfo suminfo gsm.msi
	Title: Installation Database
Subject: Impv studio
Author: Beatss Inc
Keywords: Installer, MSI, Database
Comments: This installer database contains the logic and data required to install Impv studio.
Template: ;1033
Last author: 
Revision number (UUID): {32CC3CB8-8734-4CAA-8F29-C1CE70440B8D}
Last printed: Fri Dec 11 04:47:44 2009
Created: Fri Dec 11 04:47:44 2009
Last saved: Fri Sep 18 08:06:51 2020
Version: 200 (c8)
Source: 10 (a)
Application: Impv studio
Security: 0 (0)



- Downloaded the gsm
file command = gsm.msi: Composite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, MSI Installer, Last Printed: Fri Dec 11 11:47:44 2009, Create Time/Date: Fri Dec 11 11:47:44 2009, Last Saved Time/Date: Fri Sep 18 15:06:51 2020, Security: 0, Code page: 1252, Revision Number: {32CC3CB8-8734-4CAA-8F29-C1CE70440B8D}, Number of Words: 10, Subject: Impv studio, Author: Beatss Inc, Name of Creating Application: Impv studio, Template: ;1033, Comments: This installer database contains the logic and data required to install Impv studio., Title: Installation Database, Keywords: Installer, MSI, Database, Number of Pages: 200

URL seen:
178.23.190.199@80\\share  --> using port 80, so http

hashes
Letter_y50.js - 514e6350dde291e84912754efd3e5da8ed0ae213 1/60 
gsm.msi - c437c27f55f7b34dd7bd964ec48b0df6ffee985f 4/60 (identified as IceID)
extracted exe - f6c31c9cd832ae2aebcd88e7b2fa6803ae93fc83 0/71
extracted dll - 67340739f51e1134ae8f0ffc5ae9dd710e8e3a08 0/69
disk1.cab 7fdb3a6c776f0e775b41be60d457fdde9f102c19 - 3/56 (IceID)
map.dll 80803c4fcb49bcc6bcd4035d455f8c095d607424 7/71 (IceID)


strings found in the msi file:
	- Ducky 
	- Adobe Illustrator 25.2.3, SVG Export Plug-In
	-- Looks to be embedded svg file, something from PhotoShop
	- !This program cannot be run in DOS mode. >> Found this part way down
	- .text
	- .rdata
	- @.data
	- .rsrc
	- @.reloc
	- GetProcessId
	- C:\JobRelease\win\Release\custact\x86\viewer.pdb >> PDB file for this malware?
	- .rdata
	- .rdata$T
	- .rdata$r
	- .rdata$sxdata
	- .rdata$voltmd
	- .rdata$zzzdbg
	- Sleep
	- ShellExecuteExW
	- ShellExecuteW
	- SHELL32.dll
	- /(c) 2006 thawte, Inc. - For authorized use only1
	- http://t2.symcb.com
	- !http://t1.symcb.com/ThawtePCA.crl0
	- https://www.thawte.com/cps0/
	- !https://www.thawte.com/repository0W
	- msi.dll
	- NETAPI32.dll
	- SHELL32.dll
	- WS2_32.dll
	- SHLWAPI.dll
	- IPHLPAPI.DLL
	- KERNEL32.dll
	- USER32.dll
	- GDI32.dll
	- COMDLG32.dll
	- LogonUserW
	- ole32.dll
	- OLEAUT32.dll
	- This installer database contains the logic and data required to install Impv studio.
