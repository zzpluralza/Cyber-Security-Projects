/*Yara Rule for UTF-16LE defined batch file
file name run.bat 

Some malware will hide itself in a bat file, by tricking the application that is in Chinese characters, UTF-16 LE
You can see the real code in Hex editor or with strings. Removing the first two bytes restores it to ASCII
CLS command at the begining hides any errors Windows might report and reveal itself.
*/

rule runbat:
{
	meta:
		date = "Feb 21, 2024"
		author = "Garrett Burt"
		filetype = "Windows batch file (.bat)"

	strings:
		$encodedhex = {FF FE}  //appears at the beginning and tricks Windows to think it's a UTF-16 LE bat file
    $cls = "&@cls"

	condition:
    $encodedhex at 0 and $cls //looking for both the beginning hex and the @cls command

}