/* Yara Rule to catch Cleaner.exe - Keylogger and credential stealer
	https://www.virustotal.com/gui/file/ea1d61984ede5908e0840e91a71bb127efd62d836c1f76702b426fd79b57f780

*/

rule cleaner_exe:
{
	meta:
		sha1 = "b0127ea7675f6359bfa80a7bf6282bd1c989b405"
		filename = "cleaner.exe"
		date = "02/20/2024"

	strings:
		$magicbytes = {4d 5a}
		$a1 = "GetSystemTimePreciseAsFileTime"
		$a2 = "RegCreateKeyExW"
		$a3 = "SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
		$a4 = "GetTickCount64"
		$run = "SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"
		

	condition:
		$magicbytes in (0) and $run and two of ($a*)

}