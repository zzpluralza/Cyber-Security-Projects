// Yara rules to detect Main WaveBrowser.exe, wavebrowser_proxy.exe and SWUpdater.exe

//import pe

rule wavebrowsermain
{
	meta:
		filename = "wavebrowser.exe"
    author = "Garrett Burt"
    date = "2023.11.04"
    description = "Look for the main wavebrowser.exe"
	
	strings:
		$magic_bytes = { 4D 5A }
    $exe = "wavebrowser.exe"
		$pdb = "wavebrowser.exe.pdb"
		$wavesor = "Wavesor Software"
		$eight = "Eightpoint Technologies Ltd."

	condition:
      ($magic_bytes at 0) and any of them

}

rule swupdater
{
  meta:
    file = "SWUpdater.exe"
    author = "Garrett Burt"
    date = "2023.11.04"
    description = "Look for the SWUpdater used by Wavebrowser"

  strings:
    $magic_bytes = { 4D 5A }
    $wavesor1 = "Wavesor Software"
    $eight1 = "Eightpoint Technologies Ltd."
    $updatepdb = "SWUpdater_unsigned.pdb"
    $Fullco = "4Wavesor Software (Eightpoint Technologies Ltd."

  condition:
    ($magic_bytes at 0) and any of them
}

rule wavebrowser_proxy
{
  meta:
    filename = "wavebrowser_proxy.exe"
    description = "Look for the wavebrowser proxy executable used by Wavebrowser"
    author = "Garrett Burt"
    date = "2023.11.04"

  strings:
    $magic_bytes = { 4D 5A }
    $proxypdb = "wavebrowser_proxy.exe.pdb"
    $proxyexe = "wavebrowser_proxy.exe"
    $fullco = "4Wavesor Software (Eightpoint Technologies Ltd."
    $wavsor2 = "Wavesor Software"
    $Eightp = "Eightpoint Technologies Ltd."

  condition:
    ($magic_bytes at 0) and any of them
}

// Hash continues to change. Need to look via strings in the exe. Identified Wavesor, another company name and the main exe names and pdbs, all within strings
// Just identify based on one of these and it should kill it.
