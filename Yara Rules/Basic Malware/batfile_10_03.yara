# Yara Rul to detect malware analyzed on 10-03 (batfile)

rule MaliciousBat
{
	meta:
		SHA1 = "7b0f523763798939b510f29437aec76e8bf7388c"
	
	strings:
		$PShell = "powershell" nocase
		$pngbat = ".png.bat" nocase
		
	condition:
		all of them
	
}

rule extractedDLL
{
	meta:
	
		SHA1 = "b299bdbce9dc21e5e56a5a5dd180a1f62a9a0402"
	
	strings:
		$dosheader = "!This program cannot be run in DOS mode." nocase wide
		$kernel = "kernel32" nocase
		$crypto = "CryptoStreamMode" nocase
		$basesixfor = "FromBase64String" nocase
		
	condition:
	
		$dosheader and (2 of them)
}